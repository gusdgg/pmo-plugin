<?php
  $matrizDb = $model->matrizWithoutMe()->toArray();
  $matriz = json_encode($matrizDb);

  $myMatrizDb = $model->myMatriz()->toArray();
  $myMatriz = json_encode($myMatrizDb);

?>


<!-- Scoreboard -->
<div class="card"style="background-color: #fefefe;">
    <div class="card-body" >
        <div class="scoreboard" style="padding-top: 10px;padding-left: 10px;">

            <div class="scoreboard-item title-value">
                <h4>Matriz de Priorizaci√≥n</h4>
            </div>

            <div class="chart-view">
                <canvas id="matriz" width="400" height="200" style="display: block; box-sizing: border-box; height: 200px; width: 400px;"></canvas>
            </div>


        </div>
    </div>
</div>


<script type="text/javascript">
   
    quadrants = {
    id: 'quadrants',
    beforeDraw(chart, args, options) {
            const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
            const midX = x.getPixelForValue(50);
            const midY = y.getPixelForValue(50);
            ctx.save();
            ctx.fillStyle = options.topLeft;
            ctx.fillRect(left, top, midX - left, midY - top);
            ctx.fillStyle = options.topRight;
            ctx.fillRect(midX, top, right - midX, midY - top);
            ctx.fillStyle = options.bottomRight;
            ctx.fillRect(midX, midY, right - midX, bottom - midY);
            ctx.fillStyle = options.bottomLeft;
            ctx.fillRect(left, midY, midX - left, bottom - midY);
            ctx.restore();
        }
    };


    ctx = document.getElementById('matriz');

    new Chart(ctx, {
        type: 'bubble',
        data: {
        datasets: [
                {
                    label: 'Cartera',
                    data: JSON.parse('<?= $matriz ?>'),
                    backgroundColor: 'rgb(237, 194, 64)'
                },
                {
                    label: 'Esta propuesta',
                    data: JSON.parse('<?= $myMatriz ?>'),
                    backgroundColor: 'rgb(175, 216, 248)'
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                    y: {
                        title: {
                            display: true,
                            text: 'Impacto'
                        },
                        min: 0,
                        max: 100
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Esfuerzo'
                        },
                        min: 0,
                        max: 100
                    }
                },
            plugins: {
                legend: {
                    position: 'bottom'
                },
                
                quadrants: {
                    topLeft: '#ffffff',
                    topRight: '#f3f3f3',
                    bottomRight: '#ffffff',
                    bottomLeft: '#f3f3f3',
                },

            }
        },
        plugins: [quadrants]

        
    });

</script>